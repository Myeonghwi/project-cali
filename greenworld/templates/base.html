{% load staticfiles %}
<!DOCTYPE html>
<html lang="{% block html_language_code %}en{% endblock %}">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>{% block title %}그린월드 | 시뮬레이션{% endblock %}</title>

    <!-- Bootstrap Core CSS -->
    <link href="{% static 'assets/vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="{% static 'assets/css/base.css' %}" rel="stylesheet">
    <link href="{% static 'assets/css/step-wizard.css' %}" rel="stylesheet">
    <link href="{% static 'assets/css/heroic-features.css' %}" rel="stylesheet">
    <link href="{% static 'assets/css/form-elements-simulator.css' %}" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Green World</a>
            </div>
            {% if user.is_active %}
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#">게시판</a>
                    </li>
                    <li>
                        <a href="#">마이페이지</a>
                    </li>
                    <li>
                        <a href="/accounts/logout">로그아웃</a>
                    </li>
                </ul>
            </div>
            {% else %}
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#">게시판</a>
                    </li>
                    <li>
                        <a href="/accounts/register">회원가입</a>
                    </li>
                    <li>
                        <a href="/accounts/login">로그인</a>
                    </li>
                </ul>
            </div>
            {% endif %}
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    {% block container %}

    {% endblock %}

    <!-- Page Content -->
    <div class="container">

        <hr>

        <!-- Footer -->
        <footer>
            <div class="col-lg-8 col-lg-offset-2 text-center">
                <p>항상 당신의 소중한 의견을 기다리고 있습니다.</p>
            </div>
            <div class="col-lg-4 col-lg-offset-2 text-center">
                <i class="fa fa-phone fa-3x sr-contact"></i>
                <p>+82-10-8921-4701</p>
            </div>
            <div class="col-lg-4 text-center">
                <i class="fa fa-envelope-o fa-3x sr-contact"></i>
                <p><a href="mailto:your-email@your-domain.com">ddkddk35@yonsei.ac.kr</a></p>
            </div>
        </footer>

    </div>
    <!-- /.container -->


    <!-- Daum API -->
    <script src="http://dmaps.daum.net/map_js_init/postcode.v2.js"></script>
    
    <script>
        function DaumPostcode() {
        new daum.Postcode({
            oncomplete: function(data) {
                // 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

                // 도로명 주소의 노출 규칙에 따라 주소를 조합한다.
                // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
                var fullRoadAddr = data.roadAddress; // 도로명 주소 변수
                var extraRoadAddr = ''; // 도로명 조합형 주소 변수

                // 법정동명이 있을 경우 추가한다. (법정리는 제외)
                // 법정동의 경우 마지막 문자가 "동/로/가"로 끝난다.
                if(data.apartment === 'N') {
                    alert("공동주택이 아닙니다.")
                }
                if(data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
                    extraRoadAddr += data.bname;
                }
                // 건물명이 있고, 공동주택일 경우 추가한다.
                if(data.buildingName !== '' && data.apartment === 'Y'){
                   extraRoadAddr += (extraRoadAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                }
                // 도로명, 지번 조합형 주소가 있을 경우, 괄호까지 추가한 최종 문자열을 만든다.
                if(extraRoadAddr !== ''){
                    extraRoadAddr = ' (' + extraRoadAddr + ')';
                }
                // 도로명, 지번 주소의 유무에 따라 해당 조합형 주소를 추가한다.
                if(fullRoadAddr !== ''){
                    fullRoadAddr += extraRoadAddr;
                }

                // 우편번호와 주소 정보를 해당 필드에 넣는다.
                document.getElementById('postcode').value = data.zonecode; //5자리 새우편번호 사용
                document.getElementById('roadAddress').value = fullRoadAddr;
                document.getElementById('jibunAddress').value = data.jibunAddress;

                //document.getElementById('apt-name').innerHTML = '공동주택 명 : ' + data.buildingName;
                openApiApartment(data.sigunguCode + data.roadnameCode);

                // 사용자가 '선택 안함'을 클릭한 경우, 예상 주소라는 표시를 해준다.
                if(data.autoRoadAddress) {
                    //예상되는 도로명 주소에 조합형 주소를 추가한다.
                    var expRoadAddr = data.autoRoadAddress + extraRoadAddr;
                    document.getElementById('guide').innerHTML = '(예상 도로명 주소 : ' + expRoadAddr + ')';

                } else if(data.autoJibunAddress) {
                    var expJibunAddr = data.autoJibunAddress;
                    document.getElementById('guide').innerHTML = '(예상 지번 주소 : ' + expJibunAddr + ')';

                } else {
                    document.getElementById('guide').innerHTML = '';
                }
            }
            }).open();
        }
    </script>

    <script>
        function openApiApartment(code) {
            apikey = "qmtrltW6G7zoOxVeLWJJ%2FE%2BYEnmZeicm4b8mQQmJPnS1ZKDpg1dg1xLMIiKfzleMVxHD%2F9%2FvECvVBINhw2QcEw%3D%3D";
            apartmentRESTURL = "http://apis.data.go.kr/1611000/AptListService/getRoadnameAptList";
            apartmentRESTURL += "?serviceKey=" + apikey;
            apartmentRESTURL += "&loadCode=" + code;
            apartmentRESTURL += "&pageNo=1";
            apartmentRESTURL += "&startPage=1";
            apartmentRESTURL += "&numOfRows=10";
            apartmentRESTURL += "&pageSize=10";
            console.log(apartmentRESTURL);
            $.ajax({
                url: apartmentRESTURL,
                dataType: "xml",
                type: 'GET',
                success: function(res) {
                    var xml = $(res.responseText).find("items");
                    var listLength = xml.length;

                    if(listLength) {

                        $(xml).each(function() {
                            console.log(xml);
                            //console.log($(this).find("kaptName").text());
                            //console.log($(this).find("kaptCode").text());
                        
                        })
                    }
                }
            });
        }

    </script>

    <style>
        .jumbotron simulation a{cursor: pointer;}
        .jumbotron simulation .hide{display: none;}
    </style>
    
    <script>
        $(document).ready(function() {
            $(".jumbotron simulation>a").click(finction() {
                $(this).next("ul").toggleClass("hide");
            })
        })
    </script>

    <!-- Cross Domain Solution -->
    <script src="{% static 'assets/js/jquery.xdomainajax.js' %}"></script>
    <script src="{% static 'assets/js/xml2json.js' %}"></script>

    <!-- jQuery -->
    <script src="{% static 'assets/vendor/jquery/jquery.min.js' %}"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="{% static 'assets/vendor/bootstrap/js/bootstrap.min.js' %}"></script>

    <!-- Morris Chart -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.2/raphael-min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.0/morris.min.js'></script>

    <script src="{% static 'assets/js/index.js' %}"></script>


</body>

</html>
